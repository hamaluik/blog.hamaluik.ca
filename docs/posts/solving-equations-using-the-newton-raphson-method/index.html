<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Solving Equations Using the Newton-Raphson Method</title>
    <link href="https://fonts.googleapis.com/css?family=Crimson+Pro:400,400i,700|Eczar:800|Fira+Code&display=swap" rel="stylesheet">
    <link href="/style.css" rel="stylesheet"> 
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
    <link rel="manifest" href="/assets/site.webmanifest">
    <link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#bf616a">
    <meta name="msapplication-TileColor" content="#bf616a">
    <meta name="theme-color" content="#bf616a">
</head>

<body>
    <svg style="position:absolute;width:0;height:0;display:none;" xmlns="http://www.w3.org/2000/svg" overflow="hidden">
        <defs>
            <symbol id="ca" viewBox="0 0 43 32">
                <path fill="var(--color1, #fff)" d="M10.012 0h22.642v32H10.012z" />
                <path fill="var(--color2, #bf616a)"
                    d="M-1.309 0h11.321v32H-1.309zm33.963 0h11.321v32H32.654zM13.398 15.463l-.879.3 4.091 3.59c.309.923-.108 1.195-.373 1.679l4.441-.564-.116 4.47.92-.026-.201-4.432 4.446.527c-.275-.581-.52-.89-.265-1.819l4.088-3.402-.715-.259c-.585-.451.253-2.174.379-3.261 0 0-2.387.821-2.544.391l-.608-1.168-2.172 2.386c-.237.057-.338-.037-.394-.238l1.003-4.985-1.589.894c-.133.057-.266.008-.354-.147l-1.528-3.066-1.576 3.184c-.119.114-.238.127-.336.05l-1.513-.849.908 4.946c-.072.196-.245.252-.449.145l-2.076-2.359c-.272.435-.456 1.146-.815 1.305-.359.149-1.561-.301-2.367-.477.275.993 1.136 2.644.591 3.185z" />
            </symbol>
        </defs>
    </svg>
    <header>
        <h1><a href="/">Kenton Hamaluik</a></h1>
    </header>
    <article>
        <header>
            <h1>Solving Equations Using the Newton-Raphson Method</h1>
        </header>
        <p>Computers are great, but as it turns out - they’re not always the smartest of folks. However, they are great at doing simple math! Today, I’ll show you how to exploit these silicon monsters to do something that sometimes humans even fail at: solving a simple non-linear equation.</p>
<!-- PELICAN_END_SUMMARY -->
<p>What do I mean by solving a non-linear equation? Well, try solving for <em>x</em> in the following equation:</p>
<p>$$
5x+\ln\left(x\right)-\sin\left(3\pi x\right)+x^{0.53}=0
$$</p>
<p>It’s not even likely that there <strong>is</strong> an analytical solution to this, but if there is the amount of work needed to solve it would simply be ludicrous. This is where numerical methods come in. Numerical methods allow complicated equations to be solved by repeatedly solving a series of smaller, easier-to-solve equations. They’re limited in that they’re <strong>not exact</strong> equations, but most often they do the job well enough regardless.</p>
<p>One the most famous (and simple) of numerical methods is the <a href="http://en.wikipedia.org/wiki/Newton's_method">Newton-Raphson</a> method. This is a method for find the local roots of a real function. If you want more details about it, head over to Wikipedia, but basically the formula is like such:</p>
<p>$$
x_{n+1}=x_n-\frac{f(x_n)}{f’(x_n)}
$$</p>
<p>This simply means that you start with an initial guess, <em>Xn</em>, that you think is reasonably close to your answer (you can often get a good indication of this by plotting the function and seeing about where it hits 0). Next, you successively update your guess of what <em>x</em> is by making adjustment based on the slope of the function. Finally, you stop improving your guess of what <em>x</em> is once the error (or value of plugging in your estimated <em>x</em> is in the function) is reasonably small.</p>
<p>To demonstrate, I’ve whipped up a simple program in Python which will solve the above problem. It’s quite heavily commented, so hopefully you won’t have any trouble following along. Here’s the source code listing:</p>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># the x function, effectively return the</span>
<span class="c1"># deviation from 0 for any give x</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="k">return</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mf">0.53</span>

<span class="c1"># return the central-difference differential</span>
<span class="c1"># with a width of c centered about x</span>
<span class="k">def</span> <span class="nf">dx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>

<span class="c1"># the Newton-Raphson method! For a given initial</span>
<span class="c1"># x value, width of the central-difference method,</span>
<span class="c1"># and maximum error desired in the results, will</span>
<span class="c1"># calculate the local zero of the function!</span>
<span class="k">def</span> <span class="nf">Newton</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">maxError</span><span class="p">):</span>
	<span class="c1"># initialize arrays</span>
	<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span>
	<span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">function</span><span class="p">(</span><span class="n">x0</span><span class="p">)]</span>

	<span class="c1"># now loop to solve!</span>
	<span class="k">while</span> <span class="n">fabs</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">maxError</span><span class="p">:</span>
		<span class="c1"># calculate the next x</span>
		<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">)))</span>
		<span class="c1"># update the error estimate</span>
		<span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>

	<span class="c1"># and print out the results</span>
	<span class="nb">print</span> <span class="s1">&#39;i</span><span class="se">\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">error&#39;</span>
	<span class="nb">print</span> <span class="s1">&#39;---&#39;</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
		<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="se">\t</span><span class="si">%.3f</span><span class="se">\t</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># call the Newton-Raphson method with an initial</span>
<span class="c1"># guess of 0.25, a central difference width of 0.001</span>
<span class="c1"># and a maximum error of 0.001</span>
<span class="n">startTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">Newton</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">endTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;Total process took </span><span class="si">%f</span><span class="s1"> seconds!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">endTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">)</span>
</pre></div>
<p>Running this code results in the following:</p>
<div class="highlight"><pre><span></span><span class="err">i	x	error</span>
<span class="err">---</span>
<span class="err">1	0.250	-0.364</span>
<span class="err">2	0.272	0.010</span>
<span class="err">3	0.271	0.000</span>
<span class="err">Total process took 0.003000 seconds!</span>
</pre></div>
<p>As you can see, the value of <em>x</em> that solved the above equation to an accuracy of better than 0.001 in 3 ms! Note: it probably took even less time that that, but my system clock might not be that accurate / printing to the screen is a relatively slow business. In case you’re curious, an <em>x</em> value of 0.271 will make the above equation equal 0.</p>
<p>Pretty neat huh?</p>

    </article>
    <footer>
        <p><svg class="icon icon-ca">
                <use xlink:href="#ca"></use>
            </svg> Made in Canada.</p>
    </footer>
</body>

</html>